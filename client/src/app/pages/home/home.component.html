<nz-affix>
    <div class="container" style="margin-top: 4.5em; padding-bottom: 1em; padding-top: 1em; background: white;">
        <nz-spin nzTip="Chgecking URL..." [nzSpinning]="isLoading" [nzDelay]="200">
            <nz-input-group nzSearch nzSize="large" [nzAddOnAfter]="suffixButton">
                <input [(ngModel)]="inputData" (keypress)="inputKeyPress($event)" [autocomplete]="false" type="text"
                    nz-input placeholder="Verify a link" [(disabled)]="isLoading" />
            </nz-input-group>
            <ng-template #suffixButton>
                <button nz-button nzType="primary" nzSize="large" nzSearch (click)="searchThreat();" [nzLoading]="isLoading"
                    [(disabled)]="isLoading">Search</button>
            </ng-template>
            <h3>{{inputData}}</h3>
        </nz-spin>

        <div *ngIf="isLoading">
            <nz-badge nzStatus="success"></nz-badge>
            <nz-badge nzStatus="error"></nz-badge>
            <nz-badge nzStatus="warning"></nz-badge>

            <nz-progress [nzShowInfo]="false" [nzPercent]="99.9" [nzStrokeColor]="{ '0%': '#108ee9', '100%': '#87d068' }"
                nzStatus="active"></nz-progress>
        </div>
    </div>
</nz-affix>

<nz-empty *ngIf="!serverData" [nzNotFoundContent]="contentTpl">
    <ng-template #contentTpl>
        <span> Use the <a href="#trigger-tooltip">searchbox</a> </span>
    </ng-template>
</nz-empty>

<div *ngIf="serverData && googleReporData && googleReporData.matches" class="container" style="margin-top: 2em;">
    <nz-card nzHoverable [nzCover]="coverTemplate" [nzBordered]="true">

    </nz-card>
    <ng-template #coverTemplate>
        <nz-result nzStatus="500" nzTitle="Malicious Link" nzSubTitle="We found something">
            <div nz-result-extra>
                <button nz-button nzType="primary">Latest threats</button>
            </div>
        </nz-result>
    </ng-template>
</div>

<div *ngIf="serverData && googleReporData && !googleReporData.matches" class="container">
        <nz-card nzHoverable [(nzLoading)]="isLoading">
            <nz-result nzStatus="success" nzTitle="No malicious threats detected!" nzSubTitle="URL: {{inputData}}">
                <div nz-result-extra>
                    <button nz-button>Latest threats</button>
                </div>
            </nz-result>
        </nz-card>
    </div>

<div *ngIf="serverData" class="container">
    <nz-divider nzText="Report result"></nz-divider>
    <p>
        This is a generated report with the help of <a href="https://developers.google.com/safe-browsing"><strong>Google
                Safe Browsing API</strong></a> and <a href="https://www.linkpreview.net/"><strong>Link Preview API</strong></a>
    </p>
    <p>
        Please note that the link preview images might not be displayed due to CORS restrictions.
    </p>
</div>

<div class="container" *ngIf="serverData && googleReporData && googleReporData.matches">
    <div nz-row>
        <div nz-col [nzSpan]="6">
            <nz-card *ngIf="displayImage" nzHoverable style="width:240px" [nzCover]="prewviewImage">
                <nz-card-meta [nzTitle]="linkPreviewData.title" [nzDescription]="linkPreviewData.description"></nz-card-meta>
                <ng-template #prewviewImage>
                    <img alt="example" src="https://elements-cover-images-0.imgix.net/b8257cc6-0d65-4b39-a919-7e0869f41fce?auto=compress%2Cformat&fit=max&w=1370&s=ac03af4d872b968ea2674aeca7d36242"
                        crossorigin="anonymous" />
                </ng-template>
            </nz-card>
        </div>
        <div nz-col [nzSpan]="18">
            <nz-card>
                <nz-timeline>
                    <nz-timeline-item nzColor="green">
                        <nz-descriptions nzTitle="Google API">
                            <nz-descriptions-item nzTitle="Entry type">{{googleReporData.matches[0].threatEntryType}}</nz-descriptions-item>
                            <nz-descriptions-item nzTitle="Threat type">{{googleReporData.matches[0].threatType}}</nz-descriptions-item>
                            <nz-descriptions-item nzTitle="Platform type">{{googleReporData.matches[0].platformType}}</nz-descriptions-item>
                            <nz-descriptions-item nzTitle="Cache duration">{{googleReporData.matches[0].cacheDuration}}</nz-descriptions-item>
                            <nz-descriptions-item nzTitle="Status">
                                <nz-badge nzStatus="processing" nzText="Running"></nz-badge>
                            </nz-descriptions-item>
                        </nz-descriptions>
                    </nz-timeline-item>
                    <nz-timeline-item nzColor="red">
                        <nz-descriptions nzTitle="Link preview API">
                            <nz-descriptions-item nzTitle="Title">{{linkPreviewData.title}}</nz-descriptions-item>
                            <nz-descriptions-item nzTitle="Description">{{linkPreviewData.description}}</nz-descriptions-item>
                            <nz-descriptions-item nzTitle="Image Preview">{{linkPreviewData.image}}</nz-descriptions-item>
                        </nz-descriptions>
                    </nz-timeline-item>
                    <nz-timeline-item nzColor="gray">
                            <nz-descriptions nzTitle="Search item">
                                    <nz-descriptions-item nzTitle="URL">{{linkPreviewData.url}}</nz-descriptions-item>
                            </nz-descriptions>
                    </nz-timeline-item>
                </nz-timeline>
            </nz-card>
        </div>
    </div>
</div>